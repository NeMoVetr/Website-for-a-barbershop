# Система онлайн-бронирования услуг «VolgTek»

Этот проект – веб-приложение, реализующее систему онлайн-расписания и бронирования услуг.  Заказчики (клиенты) могут регистрироваться, просматривать доступных мастеров и услуги, выбирать дату и время, а сотрудники (мастера) ведут своё расписание.  Администратор управляет справочниками «Залы», «Услуги» и «Сотрудники».

> Репозиторий содержит полноценное Django-приложение, готовое к локальному запуску и дальнейшему развёртыванию.

---

## Основные возможности

| Роль              | Возможности |
|-------------------|-------------|
| **Клиент**        | • Регистрация/авторизация  <br>• Просмотр профиля и его редактирование  <br>• Поиск мастеров по имени/фамилии/услуге/залу  <br>• Бронирование визита (дата, услуга, мастер, время)  <br>• Просмотр, изменение или отмена своих записей |
| **Сотрудник**     | • Просмотр собственного расписания  <br>• Автоматическое обновление статусов визитов |
| **Администратор** | • CRUD для залов, услуг, сотрудников  <br>• Назначение услуг мастерам и распределение по залам  <br>• Просмотр всех визитов |

Технические особенности:

* Расписание формируется автоматически с учётом длительности услуги, загруженности зала и графика работы.
* При сохранении сущностей используются кастомные методы `save()` для автоматического создания связей (см. модели `Employee`, `Visit`).
* На клиенте используется небольшой JS-скрипт (`static/script/update_time_regarding_date.js`) для динамического обновления выпадающего списка времени на форме бронирования.

---

## Стек технологий

* Python 3.10+
* Django 4.x
* SQLite (по умолчанию) / любой другой поддерживаемый Django DB
* Bootstrap 5

---

## Быстрый запуск

1. Клонируйте репозиторий и перейдите в каталог проекта:

   ```bash
   git clone <repo-url>
   cd volgtekproject
   ```

2. Создайте виртуальное окружение и активируйте его (рекомендуется):

   ```bash
   python -m venv venv
   source venv/bin/activate          # Windows: venv\Scripts\activate
   ```

3. Установите зависимости:

   ```bash
   pip install django pandas
   ```

4. Выполните миграции и создайте суперпользователя:

   ```bash
   python manage.py migrate
   python manage.py createsuperuser
   ```

5. Запустите development-сервер:

   ```bash
   python manage.py runserver
   ```

6. Откройте браузер: <http://127.0.0.1:8000>

---

## Структура проекта

```
volgtekproject/
├── manage.py                # точка входа Django
├── db.sqlite3               # БД (dev)
├── static/                  # статика (JS, CSS, изображения)
│   └── script/
│       └── update_time_regarding_date.js
├── volgtekproject/          # настройки сайта
│   ├── settings.py          # конфигурация Django
│   ├── urls.py              # корневые URL
│   └── ...
└── volgtekapp/              # основное приложение
    ├── models.py            # модели (Hall, Service, Employee, Client, Visit …)
    ├── form.py              # формы для CRUD и регистрации
    ├── views.py             # контроллеры / бизнес-логика
    ├── urls.py              # маршруты приложения
    ├── time_slots.py        # генерация временных слотов
    ├── templates/           # HTML-шаблоны (Django Templates)
    └── static/              # app-специфичная статика
```

---

## Подробности реализации

### 1. Модели (`volgtekapp.models`)

| Модель | Назначение | Ключевые поля |
|--------|-----------|---------------|
| `Hall` | справочник залов | `name`, `start_time`, `end_time`, `capacity` |
| `Service` | справочник услуг | `name`, `price`, `duration` (TimeField) |
| `Employee` | сотрудники/мастера | связь Many-to-Many с `Hall` и `Service`; через-таблица `ServiceHall` |
| `Client` | клиенты | `user` (One-to-One c `auth.User`), `phone_number` |
| `Visit` | запись клиента | FK на `Client`, `Employee`, `Service`, `Hall`; поля `date`, `time`, `status` |

Дополнительная модель `ServiceHall` связывает «услуга ↔ зал», что позволяет быстро находить зал, где мастер оказывает конкретную услугу.

### 2. Формы (`volgtekapp.form`)

Содержит ModelForm-классы для всех CRUD‐операций, а также специальные формы регистрации клиента/сотрудника.

### 3. Вьюхи (`volgtekapp.views`)

Используются декораторы `login_required`, `staff_member_required`, `user_passes_test` для разграничения доступа (клиент/сотрудник/админ).

Ключевой алгоритм – `get_available_time()`

* При выборе мастера, услуги и даты вызывается AJAX-запрос.
* Функция с помощью утилиты `get_time_slots()` из `time_slots.py` возвращает свободные интервалы.

### 4. Генерация тайм-слотов (`time_slots.py`)

Файл содержит функции:

* `get_time_slots(hall, service, date)` – возвращает список свободных временных промежутков с учётом существующих записей (`Visit`) и длительности услуги.
* `update_status_visits()` – помечает прошедшие визиты как «Выполнена».

### 5. JavaScript

`static/script/update_time_regarding_date.js` динамически подгружает свободное время при изменении даты.

---




